<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Game Menu</title>
    <style>
      body {
        margin: 0;
        background: #1c1c1c;
        font-family: sans-serif;
        color: white;
        display: flex;
        height: 100vh;
        overflow: hidden;
      }
.title-container {
  padding: 1.5rem 0.5rem 2rem;
  text-align: center;
  border-bottom: 2px solid #2c2c2c;
  margin-bottom: 1rem;
}

.game-title-image {
  max-width: 100%;
  height: auto;
  object-fit: contain;
  filter: drop-shadow(0 0 8px rgba(0, 150, 255, 0.6));
  transition: transform 0.3s ease;
}

.game-title-image:hover {
  transform: scale(1.03);
}

/* Adjust sidebar layout */
.sidebar {
  display: flex;
  flex-direction: column;
  gap: 1rem;
        width: 200px;
        background: #111;
        padding: 2rem 1rem;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        border-right: 2px solid #2c2c2c;
      }

      .menu-button {
        font-size: 1.2rem;
        padding: 0.75rem 1rem;
        background: linear-gradient(135deg, #2c2c2c, #1f1f1f);
        border: none;
        border-radius: 10px;
        color: white;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .menu-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
      }

      .content {
        flex: 1;
        padding: 2rem;
        overflow-y: auto;
      }

      .section {
        display: none;
      }

      .section.active {
        display: block;
      }

.level-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 2rem;
  max-width: 1000px;
  width: 100%; /* Add this */
}

      .level-button {
        background: linear-gradient(135deg, #2c2c2c, #1f1f1f);
        border-radius: 12px;
        overflow: hidden;
        text-align: center;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .level-button:hover {
        transform: scale(1.06);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
      }

      .level-button img {
        width: 75%;
        aspect-ratio: 1 / 1;
        object-fit: cover;
        background: #555;
      }

      .level-name {
        padding: 0.5rem;
        font-size: 1.1rem;
        background: #222;
      }

      .editor-button {
        margin-bottom: 2rem;
        font-size: 1.3rem;
        padding: 0.75rem 2rem;
        background: linear-gradient(135deg, #007bff, #0056b3);
        border: none;
        border-radius: 10px;
        color: white;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        overflow: hidden;
      }

      .editor-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
      }

      /*hopefully fixes the weird super big button glitch */
.level-grid > .level-button {
  width: 100%; /* Make sure it respects grid cell size */
  max-width: 200px; /* Optional: Set a max width */
  margin: 0 auto; /* Center in grid cell */
}
    </style>
  </head>
  <body>
    <div class="sidebar">

        <div class="title-container">
    <img src="images/betterLogo.png" alt="Game Title" class="game-title-image">
  </div>
      
      <button class="menu-button" onclick="showSection('levels')">
        Play Levels
      </button>
      <button class="menu-button" onclick="showSection('editor')">
        Level Editor
      </button>
      <button class="menu-button" onclick="showSection('settings')">
        Settings
      </button>
    </div>

    <div class="content">
      <div id="levels" class="section active">
        <h1>Select a Level</h1>
        <div class="level-grid">
          <div class="level-button">
            <img
              src="images/placeholder.png"
              alt="Level 1"
            />
            <div class="level-name">Level 1</div>
          </div>
          <div class="level-button">
            <img
              src="images/placeholder.png"
              alt="Level 2"
            />
            <div class="level-name">Level 2</div>
          </div>
          <div class="level-button">
            <img
              src="images/placeholder.png"
              alt="Level 3"
            />
            <div class="level-name">Level 3</div>
          </div>
        </div>
      </div>

<div id="editor" class="section">
  <h1>Level Editor</h1>
  <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
    <button class="editor-button" onclick="location.href='editor.html'">+ Create New Level</button>
    <button class="editor-button" id="load-json-btn">Load JSON</button>
  </div>

  <p id="no-levels-text">No levels were created yet.</p>

  <div class="level-grid" id="loaded-levels" style="margin-top: 1rem;"></div>
</div>

<script>
  const noLevelsText = document.getElementById('no-levels-text');
  const loadedLevelsContainer = document.getElementById('loaded-levels');
  const loadJsonBtn = document.getElementById('load-json-btn');

  // Keep loaded level data in memory
  const loadedLevels = [];

  function updateNoLevelsText() {
    noLevelsText.style.display = loadedLevels.length === 0 ? 'block' : 'none';
  }

  // Create the play/edit button panel for a level
  function createActionButtons(level) {
    const container = document.createElement('div');
    container.style.marginTop = '0.5rem';
    container.style.display = 'flex';
    container.style.gap = '1rem';

    const playBtn = document.createElement('button');
    playBtn.textContent = 'Play';
    playBtn.className = 'editor-button';
    playBtn.style.padding = '0.3rem 1rem';
    playBtn.style.fontSize = '1rem';

    playBtn.onclick = () => {
      // Save JSON string to localStorage and redirect to game.html
      localStorage.setItem('mapData', level.jsonText);
      window.location.href = 'game.html';
    };

    const editBtn = document.createElement('button');
    editBtn.textContent = 'Edit';
    editBtn.className = 'editor-button';
    editBtn.style.padding = '0.3rem 1rem';
    editBtn.style.fontSize = '1rem';

editBtn.onclick = () => {
  // Save JSON string to localStorage and redirect to editor.html
  localStorage.setItem('mapData', level.jsonText);
  window.location.href = 'editor.html';
};

    container.appendChild(playBtn);
    container.appendChild(editBtn);
    return container;
  }

  // Create a level button with optional action buttons container
  function createLevelButton(level) {
    const div = document.createElement('div');
    div.className = 'level-button';
    div.style.cursor = 'pointer';
    div.style.position = 'relative';
    div.style.width = '100%'; // Add this line

    // Placeholder image
    const img = document.createElement('img');
    img.src = 'images/placeholder.png';
    img.alt = level.name;
    div.appendChild(img);

    const nameDiv = document.createElement('div');
    nameDiv.className = 'level-name';
    nameDiv.textContent = level.name;
    div.appendChild(nameDiv);

    // Action buttons container (hidden initially)
    const actionsContainer = createActionButtons(level);
    actionsContainer.style.display = 'none';
    div.appendChild(actionsContainer);

    div.addEventListener('click', () => {
      // Toggle action buttons visibility on click
      if (actionsContainer.style.display === 'none') {
        // Hide other action buttons if any
        document.querySelectorAll('.level-button > div:last-child').forEach(el => {
          el.style.display = 'none';
        });
        actionsContainer.style.display = 'flex';
      } else {
        actionsContainer.style.display = 'none';
      }
    });

    return div;
  }

  loadJsonBtn.addEventListener('click', () => {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';

    input.onchange = e => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        try {
          // Validate JSON
          JSON.parse(reader.result);

          const levelName = file.name.replace(/\.json$/i, '');
          const levelData = { name: levelName, jsonText: reader.result };

          // Prevent duplicate names
          if (loadedLevels.some(l => l.name === levelName)) {
            alert('Level with that name already loaded.');
            return;
          }

          loadedLevels.push(levelData);

          const levelBtn = createLevelButton(levelData);
          loadedLevelsContainer.appendChild(levelBtn);

          updateNoLevelsText();
        } catch (err) {
          alert('Invalid JSON file.');
        }
      };
      reader.readAsText(file);
    };

    input.click();
  });

  // Initialize on page load
  updateNoLevelsText();
</script>


      <div id="settings" class="section">
        <h1>Settings</h1>
        <p>Settings options will go here.</p>
      </div>
    </div>

    <script>
      function showSection(id) {
        document.querySelectorAll(".section").forEach((section) => {
          section.classList.remove("active");
        });
        document.getElementById(id).classList.add("active");
      }
    </script>
  </body>
</html>
